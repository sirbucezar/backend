import{r as S}from"./react-CmEzmXpT.js";function m(s){let e;const r=new Set,t=(c,u)=>{const n=typeof c=="function"?c(e):c;if(n!==e){const o=e;e=u?n:Object.assign({},e,n),r.forEach(l=>l(e,o))}},i=()=>e,g=(c,u=i,n=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=u(e);function l(){const b=u(e);if(!n(o,b)){const R=o;c(o=b,R)}}return r.add(l),()=>r.delete(l)},a={setState:t,getState:i,subscribe:(c,u,n)=>u||n?g(c,u,n):(r.add(c),()=>r.delete(c)),destroy:()=>r.clear()};return e=s(t,i,a),a}const v=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),p=v?S.useEffect:S.useLayoutEffect;function E(s){const e=typeof s=="function"?m(s):s,r=(t=e.getState,i=Object.is)=>{const[,g]=S.useReducer(y=>y+1,0),f=e.getState(),d=S.useRef(f),a=S.useRef(t),c=S.useRef(i),u=S.useRef(!1),n=S.useRef();n.current===void 0&&(n.current=t(f));let o,l=!1;(d.current!==f||a.current!==t||c.current!==i||u.current)&&(o=t(f),l=!i(n.current,o)),p(()=>{l&&(n.current=o),d.current=f,a.current=t,c.current=i,u.current=!1});const b=S.useRef(f);p(()=>{const y=()=>{try{const w=e.getState(),h=a.current(w);c.current(n.current,h)||(d.current=w,n.current=h,g())}catch{u.current=!0,g()}},O=e.subscribe(y);return e.getState()!==b.current&&y(),O},[]);const R=l?o:n.current;return S.useDebugValue(R),R};return Object.assign(r,e),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const t=[r,e];return{next(){const i=t.length<=0;return{value:t.shift(),done:i}}}},r}function D(s,e){if(Object.is(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;const r=Object.keys(s);if(r.length!==Object.keys(e).length)return!1;for(let t=0;t<r.length;t++)if(!Object.prototype.hasOwnProperty.call(e,r[t])||!Object.is(s[r[t]],e[r[t]]))return!1;return!0}const j=s=>(e,r,t)=>{const i=t.subscribe;return t.subscribe=(f,d,a)=>{let c=f;if(d){const u=(a==null?void 0:a.equalityFn)||Object.is;let n=f(t.getState());c=o=>{const l=f(o);if(!u(n,l)){const b=n;d(n=l,b)}},a!=null&&a.fireImmediately&&d(n,n)}return i(c)},s(e,r,t)};export{j as a,E as c,D as s};
