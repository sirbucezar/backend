import{j as e,r as t}from"./react-CmEzmXpT.js";import{c as Ne}from"./react-dom-DXFLI2Zf.js";import{N as _e,u as ke,R as pe,a as J,B as ye,b as Ee}from"./react-router-Bb8yUrVe.js";import{u as fe,a as Le,H as Ie,b as Ce,C as Te,P as $e}from"./@react-three-BuG2Palz.js";import{a2 as Be}from"./three-B6NbTccM.js";import"./leva-DHFZQhGE.js";import{u as de}from"./react-responsive-BhQXqIBZ.js";import{g as ue}from"./gsap-DaYL4gH5.js";import{e as Pe}from"./maath-B301nOMh.js";import{c as k,O as Me}from"./sonner-B8bgJVvv.js";import"./assign-symbols-T0ZjG-DD.js";import"./cookie--_YQFYBD.js";import"./debounce-D1lbXHVv.js";import"./its-fine-BSQV0PKa.js";import"./react-reconciler-BrIjypLO.js";import"./scheduler-D0oS9gf5.js";import"./@babel-CF3RwP-h.js";import"./three-stdlib-DjzL-lb7.js";import"./zustand-C-t82aId.js";import"./suspend-react-BKIKQNXN.js";import"./@radix-ui-Bax1LoxT.js";import"./@floating-ui-BGisLwHw.js";import"./dequal-CnqicUFC.js";import"./v8n-93uuTh_4.js";import"./@stitches-FmyCXE5L.js";import"./@use-gesture-DLtpIbzk.js";import"./colord-C4etA4kz.js";import"./react-colorful-CCN0lGaG.js";import"./react-dropzone-CZ2UsFX2.js";import"./prop-types-CEtiM3Ss.js";import"./file-selector-BYzI3Mo1.js";import"./tslib-DTLQ5SHO.js";import"./attr-accept--eDnxCgl.js";import"./merge-value-BEeLj4vv.js";import"./is-extendable-34YFXLlF.js";import"./is-plain-object-CQ5lcLGj.js";import"./isobject-nfgcKFwJ.js";import"./mixin-deep-DqLrP_z9.js";import"./for-in-DN4Omt8s.js";import"./get-value-DNM4XnJX.js";import"./set-value-NE5BXWM7.js";import"./split-string-CjBVBAbN.js";import"./extend-shallow-BULDLYXf.js";import"./matchmediaquery-D40JjXL9.js";import"./css-mediaquery-DL3IrIfu.js";import"./hyphenate-style-name-HOLnhz8K.js";import"./shallow-equal-BQUY1Bas.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))_(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const a of d.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&_(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function _(i){if(i.ep)return;i.ep=!0;const d=n(i);fetch(i.href,d)}})();const Ae=()=>e.jsx("div",{children:"Login"}),Re="_canvas_brrvl_1",De="_hero_brrvl_6",me={canvas:Re,hero:De},Fe=o=>{const c=t.useRef(null),{nodes:n,materials:_}=fe("/models/wireframe_man.glb");return e.jsx("group",{...o,dispose:null,ref:c,children:e.jsx("group",{scale:.01,children:e.jsxs("group",{position:[0,-1e4,0],rotation:[-Math.PI/2,0,Math.PI/2],scale:1e4,children:[e.jsx("primitive",{object:n._rootJoint}),e.jsx("skinnedMesh",{geometry:n.Object_7.geometry,skeleton:n.Object_7.skeleton,material:new Be({color:"#2C919D"})})]})})})};fe.preload("/models/wireframe_man.glb");const Ve="_canvasLoader_1bucs_1",He="_title_1bucs_10",qe="_loader_1bucs_17",he={canvasLoader:Ve,title:He,loader:qe,"l9-0":"_l9-0_1bucs_1","l9-1":"_l9-1_1bucs_1","l9-2":"_l9-2_1bucs_1"},Oe=()=>{const{progress:o}=Le();return t.useEffect(()=>{console.log(o)},[o]),e.jsx(Ie,{as:"div",fullscreen:!0,children:e.jsx("div",{className:he.canvasLoader,children:e.jsx("div",{className:he.loader})})})},Ue=({children:o,isAnimEnded:c})=>{const n=t.useRef(null);return Ce((_,i)=>{c&&Pe.dampE(n.current.rotation,[_.pointer.y/6,-_.pointer.x/8,0],.4,i)}),e.jsx("group",{ref:n,children:o})},We=()=>{de({maxWidth:440}),de({maxWidth:768}),de({query:"(min-width: 768px) and (max-width: 1024px)"});const o=4;let c;const n=t.useRef(null),[_,i]=t.useState(!1),[d,a]=t.useState(!1);t.useEffect(()=>{_&&n.current&&(ue.to(n.current.position,{x:0,y:0,z:30,duration:o,ease:"power1.inOut"}),ue.to(n.current.rotation,{x:0,y:0,z:0,duration:o,ease:"power1.inOut"}),c=setTimeout(()=>{a(!0)},o*1e3))},[_]),t.useEffect(()=>()=>{clearTimeout(c)},[]);const h=w=>{n.current=w,i(!0)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:me.hero,children:e.jsx(Te,{className:me.canvas,style:{height:"100%",width:"100%",overflow:"hidden"},children:e.jsxs(t.Suspense,{fallback:e.jsx(Oe,{}),children:[e.jsx($e,{makeDefault:!0,position:[20,-50,0],rotation:[-Math.PI/2,0,Math.PI/4],onUpdate:h}),e.jsx(Ue,{isAnimEnded:d,children:e.jsx(Fe,{scale:.5,position:[0,-40,-10],rotation:[-3.3,-1.9,-3.3]})}),e.jsx("ambientLight",{intensity:1}),e.jsx("directionalLight",{position:[10,10,10],intensity:.7})]})})})})},ze="_topBar_1x46g_1",Je="_topBar__list_1x46g_6",Ke="_topBar__link_1x46g_11",Xe="_topBar__link_active_1x46g_23",P={topBar:ze,topBar__list:Je,topBar__link:Ke,topBar__link_active:Xe},Qe=()=>e.jsx("div",{className:P.topBar,children:e.jsxs("ul",{className:P.topBar__list,children:[e.jsx("li",{className:P.topBar__item,children:e.jsx(_e,{to:"/",className:({isActive:o})=>o?`${P.topBar__link} ${P.topBar__link_active}`:P.topBar__link,children:"New analysis"})}),e.jsx("li",{className:P.topBar__item,children:e.jsx(_e,{to:"/history",className:({isActive:o})=>o?`${P.topBar__link} ${P.topBar__link_active}`:P.topBar__link,children:"History"})})]})}),Ze="_newAnalysis_15ngn_16",Ge="_newAnalysis__title_15ngn_19",Ye="_newAnalysis__main_15ngn_25",et="_newAnalysis__left_15ngn_31",tt="_newAnalysis__submit_15ngn_34",st="_disabled_15ngn_51",W={newAnalysis:Ze,newAnalysis__title:Ge,newAnalysis__main:Ye,newAnalysis__left:et,newAnalysis__submit:tt,disabled:st},ot="_uploadVideo__body_1us0j_1",nt="_uploadVideo__title_1us0j_7",it="_uploadVideo__fileName_1us0j_13",at="_uploadButton_1us0j_19",rt="_uploadIcon_1us0j_39",dt="_uploadInput_1us0j_49",z={uploadVideo__body:ot,uploadVideo__title:nt,uploadVideo__fileName:it,uploadButton:at,uploadIcon:rt,uploadInput:dt},ct=({onUpload:o,fileName:c,setFileName:n})=>{const _=i=>{const d=i.target.files[0];if(d){const a=d.name;o&&(o(d),n(a))}};return e.jsx("div",{className:z.uploadVideo,children:e.jsxs("div",{className:z.uploadVideo__body,children:[e.jsxs("label",{htmlFor:"videoUpload",className:z.uploadButton,children:[e.jsx("div",{className:z.uploadIcon,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",children:e.jsx("path",{d:"M246.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 109.3 192 320c0 17.7 14.3 32 32 32s32-14.3 32-32l0-210.7 73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-64z"})})}),"Upload a Video"]}),e.jsx("input",{type:"file",id:"videoUpload",accept:"video/*",className:z.uploadInput,onChange:_}),!!c&&e.jsx("div",{className:z.uploadVideo__fileName,children:e.jsx("p",{children:c})})]})})},lt="_chooseStudent__main_xdq0e_1",_t="_chooseStudent__wrapper_xdq0e_5",ut="_chooseStudent__text_xdq0e_8",mt="_active_xdq0e_15",ht="_chooseStudent__label_xdq0e_18",vt="_chooseStudent__dropdown_xdq0e_44",pt="_chooseStudent__new_xdq0e_58",ft="_chooseStudent__labelNew_xdq0e_75",gt="_chooseStudent__inputNewWrapper_xdq0e_81",xt="_chooseStudent__inputs_xdq0e_86",St="_chooseStudent__inputNew_xdq0e_81",wt="_chooseStudent__buttons_xdq0e_112",jt="_chooseStudent__btnBack_xdq0e_118",bt="_chooseStudent__btn_xdq0e_118",Nt="_chooseStudent__search_xdq0e_150",kt="_chooseStudent__input_xdq0e_81",yt="_chooseStudent__list_xdq0e_177",Et="_chooseStudent__item_xdq0e_200",Lt="_chooseStudent__empty_xdq0e_221",It="_chooseStudent__add_xdq0e_231",u={chooseStudent__main:lt,chooseStudent__wrapper:_t,chooseStudent__text:ut,active:mt,chooseStudent__label:ht,chooseStudent__dropdown:vt,chooseStudent__new:pt,chooseStudent__labelNew:ft,chooseStudent__inputNewWrapper:gt,chooseStudent__inputs:xt,chooseStudent__inputNew:St,chooseStudent__buttons:wt,chooseStudent__btnBack:jt,chooseStudent__btn:bt,chooseStudent__search:Nt,chooseStudent__input:kt,chooseStudent__list:yt,chooseStudent__item:Et,chooseStudent__empty:Lt,chooseStudent__add:It},Ct=({setSelectedStudent:o})=>{const[c,n]=t.useState([{id:1,firstName:"Mykyta",lastName:"Tsykunov",isSelected:!1},{id:2,firstName:"Cezar",lastName:"Sîrbu",isSelected:!1},{id:3,firstName:"Danylo",lastName:"Bordunov",isSelected:!1},{id:4,firstName:"Alex",lastName:"Johnson",isSelected:!1},{id:5,firstName:"Maria",lastName:"Smith",isSelected:!1},{id:6,firstName:"Elena",lastName:"Brown",isSelected:!1}]),[_,i]=t.useState(""),[d,a]=t.useState("Choose a student"),[h,w]=t.useState(!1),[y,b]=t.useState(!1),[E,S]=t.useState(""),[j,L]=t.useState(""),I=t.useRef(null),C=c.filter(l=>`${l.firstName} ${l.lastName}`.toLowerCase().includes(_.toLowerCase())),V=l=>{l.preventDefault(),E.trim()!==""&&j.trim()!==""&&(n([...c,{id:Date.now(),firstName:E.trim(),lastName:j.trim(),isSelected:!1}]),i(""),b(!1))},T=()=>{w(l=>!l),h||i("")},R=l=>{I.current&&!I.current.contains(l.target)&&(w(!1),b(!1))},$=l=>{a(`${l.firstName} ${l.lastName}`);const A=c.map(v=>({...v,isSelected:v.id===l.id}));n(A);const K=`${l.lastName}_${l.firstName}`;o(K),w(!1)},H=()=>{b(!0),S(""),L("")},M=l=>{l.preventDefault(),i(""),b(!1)};return t.useEffect(()=>(document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}),[]),e.jsx("div",{className:u.chooseStudent,children:e.jsx("div",{className:u.chooseStudent__main,children:e.jsx("div",{className:u.chooseStudent__select,ref:I,children:e.jsxs("div",{className:u.chooseStudent__wrapper,children:[e.jsxs("div",{className:u.chooseStudent__label,children:[e.jsxs("div",{className:`${u.chooseStudent__text} ${h?u.active:""}`,onClick:T,children:[e.jsx("span",{children:d}),e.jsx("svg",{viewBox:"0 0 16 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M7.19313 9.63386C7.63941 10.122 8.36416 10.122 8.81044 9.63386L15.6653 2.13533C16.1116 1.64714 16.1116 0.854325 15.6653 0.366139C15.219 -0.122046 14.4943 -0.122046 14.048 0.366139L8 6.98204L1.95202 0.370045C1.50575 -0.118141 0.780988 -0.118141 0.334709 0.370045C-0.11157 0.858231 -0.11157 1.65104 0.334709 2.13923L7.18956 9.63777L7.19313 9.63386Z",fill:"#565356"})})]}),e.jsx("div",{className:`${u.chooseStudent__search} ${h?u.active:""}`,children:e.jsx("input",{type:"text",placeholder:"Search for a student...",value:_,onChange:l=>i(l.target.value),className:u.chooseStudent__input})})]}),e.jsxs("div",{className:`${u.chooseStudent__dropdown} ${h&&!y?u.active:""}`,children:[e.jsx("div",{className:u.chooseStudent__list,children:C.length>0?C.map(l=>e.jsxs("div",{className:`${u.chooseStudent__item} ${l.isSelected?u.active:""}`,onClick:()=>$(l),children:[l.firstName," ",l.lastName]},l.id)):e.jsx("div",{className:u.chooseStudent__empty,children:"No students found"})}),e.jsxs("button",{onClick:H,className:u.chooseStudent__add,children:[e.jsx("span",{}),"Add a new student"]})]}),e.jsxs("form",{className:`${u.chooseStudent__new} ${y?u.active:""}`,children:[e.jsx("div",{className:u.chooseStudent__labelNew,children:"Add a new student"}),e.jsxs("div",{className:u.chooseStudent__inputs,children:[e.jsx("div",{className:u.chooseStudent__inputNewWrapper,children:e.jsx("input",{type:"text",placeholder:"First Name",value:E,onChange:l=>S(l.target.value),className:u.chooseStudent__inputNew})}),e.jsx("div",{className:u.chooseStudent__inputNewWrapper,children:e.jsx("input",{type:"text",placeholder:"Last Name",value:j,onChange:l=>L(l.target.value),className:u.chooseStudent__inputNew})})]}),e.jsxs("div",{className:u.chooseStudent__buttons,children:[e.jsx("button",{type:"submit",onClick:V,className:u.chooseStudent__btn,children:"Save"}),e.jsx("button",{onClick:M,className:u.chooseStudent__btnBack,children:"Back"})]})]})]})})})})},Tt="_rubrics_1v0t8_1",$t="_rubrics__list_1v0t8_4",Bt="_rubrics__item_1v0t8_9",Pt="_active_1v0t8_19",Mt="_rubrics__title_1v0t8_22",X={rubrics:Tt,rubrics__list:$t,rubrics__item:Bt,active:Pt,rubrics__title:Mt},At=({currentRubric:o,setCurrentRubric:c})=>{const[n,_]=t.useState([{id:0,name:"Start"},{id:1,name:"Sprint"},{id:2,name:"Shot Put"},{id:3,name:"Height Jump"},{id:4,name:"Hurdles (official spacing)"},{id:5,name:"Long Jump"},{id:6,name:"Discus Throw"},{id:7,name:"Javelin Throw"},{id:8,name:"Relay Race"}]),i=d=>{c(d)};return e.jsx("div",{className:X.rubrics,children:e.jsx("ul",{className:X.rubrics__list,children:n.map(({id:d,name:a})=>e.jsx("li",{onClick:()=>i({id:d,name:a}),className:`${X.rubrics__item} ${(o==null?void 0:o.id)===d?X.active:""}`,children:e.jsx("div",{className:X.rubrics__title,children:a})},d))})})},Rt="_videoEditor_j22ud_1",Dt="_videoEditor__body_j22ud_10",Ft="_videoEditor__video_j22ud_20",Vt="_videoEditor__controls_j22ud_31",Ht="_videoEditor__playPause_j22ud_42",qt="_active_j22ud_55",Ot="_playPause_j22ud_1",Ut="_videoEditor__track_j22ud_68",Wt="_videoEditor__trackTop_j22ud_75",zt="_videoEditor__tick_j22ud_83",Jt="_videoEditor__timestamp_j22ud_104",Kt="_videoEditor__rangeHandle_j22ud_112",Xt="_videoEditor__rangeHighlight_j22ud_126",Qt="_videoEditor__progress_j22ud_135",Zt="_videoEditor__progressBody_j22ud_141",Gt="_videoEditor__progressLine_j22ud_147",Yt="_videoEditor__progressTriangle_j22ud_152",N={videoEditor:Rt,videoEditor__body:Dt,videoEditor__video:Ft,videoEditor__controls:Vt,videoEditor__playPause:Ht,active:qt,playPause:Ot,videoEditor__track:Ut,videoEditor__trackTop:Wt,videoEditor__tick:zt,videoEditor__timestamp:Jt,videoEditor__rangeHandle:Kt,videoEditor__rangeHighlight:Xt,videoEditor__progress:Qt,videoEditor__progressBody:Zt,videoEditor__progressLine:Gt,videoEditor__progressTriangle:Yt},es="_videoTicks_6bwcg_1",ts="_videoTicks__tick_6bwcg_8",ss="_videoTicks__timestamp_6bwcg_31",ie={videoTicks:es,videoTicks__tick:ts,videoTicks__timestamp:ss},os=({duration:o,startScrubbing:c})=>{const n=i=>{const d=Math.floor(i/60),a=Math.floor(i%60).toString().padStart(2,"0");return`${d}:${a}`},_=()=>{const d=o/14,a=[];for(let h=0;h<=14;h++){const w=h*d,y=w/o*100;a.push(e.jsx("div",{className:ie.videoTicks__tick,style:{left:`${y}%`},children:e.jsx("span",{className:ie.videoTicks__timestamp,children:n(w)})},h))}return a};return e.jsx("div",{className:ie.videoTicks,onMouseDown:c,onTouchStart:c,children:e.jsx("div",{className:ie.videoTicks__body,children:_()})})},ns="_videoInfo__icon_i45vn_1",is="_videoInfo__content_i45vn_18",as="_active_i45vn_32",rs="_videoInfo__body_i45vn_36",ds="_videoInfo__title_i45vn_42",cs="_videoInfo__list_i45vn_48",ls="_videoInfo__item_i45vn_58",_s="_videoInfo__keys_i45vn_63",us="_videoInfo__key_i45vn_63",ms="_videoInfo__text_i45vn_83",hs="_videoInfo__close_i45vn_88",p={videoInfo__icon:ns,videoInfo__content:is,active:as,videoInfo__body:rs,videoInfo__title:ds,videoInfo__list:cs,videoInfo__item:ls,videoInfo__keys:_s,videoInfo__key:us,videoInfo__text:ms,videoInfo__close:hs},vs=()=>{const[o,c]=t.useState(!1),n=()=>{c(!0)},_=()=>{c(!1)};return e.jsxs("div",{className:p.videoInfo,children:[e.jsx("button",{className:p.videoInfo__icon,onClick:n,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 16V12M12 8H12.01M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:`${p.videoInfo__content} ${o?p.active:""}`,children:e.jsxs("div",{className:p.videoInfo__body,children:[e.jsx("div",{className:p.videoInfo__title,children:"Tips for editing"}),e.jsxs("div",{className:p.videoInfo__list,children:[e.jsxs("div",{className:p.videoInfo__item,children:[e.jsxs("div",{className:p.videoInfo__keys,children:[e.jsx("div",{className:p.videoInfo__key,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 19L5 12M5 12L12 5M5 12H19",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:p.videoInfo__key,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 12H19M19 12L12 5M19 12L12 19",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:p.videoInfo__key,children:e.jsx("span",{children:"A"})}),e.jsx("div",{className:p.videoInfo__key,children:e.jsx("span",{children:"D"})})]}),e.jsx("div",{className:p.videoInfo__text,children:"Move one frame forward/backward"})]}),e.jsxs("div",{className:p.videoInfo__item,children:[e.jsx("div",{className:p.videoInfo__key,children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 18V12H5L12 5L19 12H15V18H9Z",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("div",{className:p.videoInfo__text,children:"Hold Shift to move 10 frames"})]}),e.jsxs("div",{className:p.videoInfo__item,children:[e.jsx("div",{className:p.videoInfo__key,children:e.jsx("span",{children:"B"})}),e.jsx("div",{className:p.videoInfo__text,children:"Make a new breakpoint"})]})]}),e.jsxs("div",{className:p.videoInfo__close,onClick:_,children:[e.jsx("span",{children:"Click here to close"}),e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M15 9L9 15M9 9L15 15M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z",stroke:"black",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})})]})},ps="_videoStages_60lha_1",fs="_videoStages__body_60lha_5",gs="_videoStages__list_60lha_9",xs="_videoStages__item_60lha_17",Ss="_completed_60lha_31",ws="_active_60lha_36",js="_videoStages__save_60lha_41",F={videoStages:ps,videoStages__body:fs,videoStages__list:gs,videoStages__item:xs,completed:Ss,active:ws,videoStages__save:js},bs=({rubric:o,setRubric:c,currentStage:n,setCurrentStage:_,saveStage:i,handleStageChange:d})=>e.jsx("div",{className:F.videoStages,children:e.jsxs("div",{className:F.videoStages__body,children:[e.jsx("ul",{className:F.videoStages__list,children:o.stages.map((a,h)=>e.jsx("div",{onClick:()=>d(h),className:`${F.videoStages__item} ${n===h?F.active:""} ${a.start_time!==null&&a.end_time!==null?F.completed:""}`,children:h+1},h))}),e.jsx("button",{className:F.videoStages__save,onClick:i,children:"Save Stage"})]})}),Ns=({videoSrc:o,setIsStagesSaved:c,rubric:n,setRubric:_})=>{const[i,d]=t.useState(0),a=t.useRef(null),h=t.useRef(null),[w,y]=t.useState(0),[b,E]=t.useState(0),[S,j]=t.useState(0),[L,I]=t.useState(0),[C,V]=t.useState(!1),[T,R]=t.useState(!1);t.useState(!1),t.useState(0);const[$,H]=t.useState(30),[M,l]=t.useState(!1),A=10,[K,v]=t.useState(null),[g,x]=t.useState(null),[q,Z]=t.useState(!1),[ge,ce]=t.useState(!1),[xe,Se]=t.useState(0),we=()=>{const s=n.stages.map((f,B)=>B===i?{...f,start_time:S,end_time:L}:f),r={...n,stages:s};let m=0;r.stages.map(f=>{f.start_time!==null&&f.end_time!==null&&m++}),m===s.length&&c(!0),_(r)},je=s=>{x(null);const r=n.stages[s];r.start_time!==null&&r.end_time!==null?(j(r.start_time),I(r.end_time)):(j(0),I(K)),d(s),a.current&&a.current.pause()};t.useEffect(()=>{const s=a.current,r=()=>{E(s.duration)};return s&&s.addEventListener("loadedmetadata",r),()=>{s&&s.removeEventListener("loadedmetadata",r)}},[]),t.useEffect(()=>{const s=()=>{const m=a.current;if(m&&!M){const f=m.currentTime/m.duration*100;!C&&!T&&y(f)}},r=a.current;return r&&r.addEventListener("timeupdate",s),()=>{r&&r.removeEventListener("timeupdate",s)}},[M,C,T]);const G=s=>{const r=h.current,m=a.current;if(r&&m){const f=r.getBoundingClientRect(),B=s.clientX||s.touches[0].clientX,oe=Math.max(0,Math.min(B-f.left,f.width))/f.width;if(m.currentTime=oe*m.duration,!C&&!T){y(oe*100);const re=m.currentTime;Se(re)}}};t.useEffect(()=>{const s=a.current,r=()=>{E(s.duration);const m=s.webkitVideoDecodedByteCount||s.duration*30;H(m/s.duration);const f=Math.floor(s.duration*$);v(f),I(f)};return s&&s.addEventListener("loadedmetadata",r),()=>{s&&s.removeEventListener("loadedmetadata",r)}},[$]),t.useEffect(()=>{const s=()=>{const m=a.current;m&&m.currentTime/m.duration*100},r=a.current;return r&&r.addEventListener("timeupdate",s),()=>{r&&r.removeEventListener("timeupdate",s)}},[]);const be=s=>{l(!0),G(s)},O=s=>{M&&G(s)},U=()=>{l(!1)};t.useEffect(()=>{const s=r=>{const m=a.current;if(!m)return;const f=r.shiftKey?10:1,B=1/$;switch(r.key.toLowerCase()){case" ":r.preventDefault(),le();break;case"a":case"arrowleft":m.currentTime=Math.max(m.currentTime-B*f,0);break;case"d":case"arrowright":m.currentTime=Math.min(m.currentTime+B*f,b);break;case"b":if(g){const D=Math.round(m.currentTime*$);g==="start"?L-A>D&&j(D):g==="end"&&S+A<D&&I(D)}break}};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[$,b,g]),t.useEffect(()=>(M?(document.addEventListener("mousemove",O),document.addEventListener("mouseup",U),document.addEventListener("touchmove",O),document.addEventListener("touchend",U)):(document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",U),document.removeEventListener("touchmove",O),document.removeEventListener("touchend",U)),()=>{document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",U),document.removeEventListener("touchmove",O),document.removeEventListener("touchend",U)}),[M]),t.useEffect(()=>((C||T)&&(document.addEventListener("mousemove",ee),document.addEventListener("mouseup",te),document.addEventListener("touchmove",ee),document.addEventListener("touchend",te)),()=>{document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",te),document.removeEventListener("touchmove",ee),document.removeEventListener("touchend",te)}),[C,T]);const Y=(s,r)=>{r==="start"?(V(!0),x("start")):r==="end"&&(R(!0),x("end"))},ee=s=>{var m,f;const r=h.current;if(r){const B=r.getBoundingClientRect(),D=s.clientX||((f=(m=s.touches)==null?void 0:m[0])==null?void 0:f.clientX),oe=Math.max(0,Math.min(D-B.left,B.width)),re=Math.floor(b*$),ne=Math.round(oe/B.width*re);C?ne<L-A&&(G(s),j(ne)):T&&ne>S+A&&(G(s),I(ne))}},te=()=>{V(!1),R(!1);const s=a.current;s&&(s.currentTime=xe)},se=s=>{const r=Math.floor(b*$);return s/r*100},le=()=>{const s=a.current;s&&(ce(!1),Z(r=>(r?s.pause():s.play(),!r)),setTimeout(()=>{ce(!0)},0))};return e.jsxs("div",{className:N.videoEditor,children:[e.jsx(bs,{rubric:n,setRubric:_,currentStage:i,setCurrentStage:d,saveStage:we,handleStageChange:je}),e.jsxs("div",{className:N.videoEditor__body,children:[e.jsx(vs,{}),e.jsx("video",{ref:a,src:o,className:N.videoEditor__video,controls:!1}),e.jsx("div",{className:N.videoEditor__controls,onClick:le,children:e.jsx("button",{className:`${N.videoEditor__playPause} ${ge?N.active:""}`,children:q?e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fill:"#f1f1f1",d:"M6 3L20 12L6 21V3Z",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{fill:"#f1f1f1",d:"M17 4H15C14.4477 4 14 4.44772 14 5V19C14 19.5523 14.4477 20 15 20H17C17.5523 20 18 19.5523 18 19V5C18 4.44772 17.5523 4 17 4Z",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{fill:"#f1f1f1",d:"M9 4H7C6.44772 4 6 4.44772 6 5V19C6 19.5523 6.44772 20 7 20H9C9.55228 20 10 19.5523 10 19V5C10 4.44772 9.55228 4 9 4Z",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})})})]}),e.jsx(os,{duration:b,startScrubbing:be}),e.jsxs("div",{ref:h,className:N.videoEditor__track,children:[e.jsx("div",{className:N.videoEditor__rangeHighlight,style:{left:`${se(S)}%`,width:`${se(L-S)}%`}}),e.jsxs("div",{children:[e.jsx("div",{className:N.videoEditor__rangeHandle,style:{left:`${se(S)}%`},onMouseDown:s=>Y(s,"start"),onTouchStart:s=>Y(s,"start")}),e.jsx("div",{className:N.videoEditor__rangeHandle,style:{left:`${se(L)}%`},onMouseDown:s=>Y(s,"end"),onTouchStart:s=>Y(s,"end")})]}),e.jsx("div",{className:N.videoEditor__progress,style:{left:`${w}%`},children:e.jsxs("div",{className:N.videoEditor__progressBody,children:[e.jsx("div",{className:N.videoEditor__progressTriangle}),e.jsx("div",{className:N.videoEditor__progressLine})]})})]})]})},ks=()=>{const[o,c]=t.useState(!1),[n,_]=t.useState(null),[i,d]=t.useState(null),[a,h]=t.useState(null),[w,y]=t.useState(""),[b,E]=t.useState(!1),[S,j]=t.useState(!1),[L,I]=t.useState(null),[C,V]=t.useState(0),[T,R]=t.useState({video_id:"",stages:[{stage_name:"stage1",start_time:null,end_time:null},{stage_name:"stage2",start_time:null,end_time:null},{stage_name:"stage3",start_time:null,end_time:null},{stage_name:"stage4",start_time:null,end_time:null},{stage_name:"stage5",start_time:null,end_time:null}]}),$=v=>{_(v),h(v.name)},H=v=>{if(!v)return"";const g=v.trim().split(/\s+/);return g.length>=2?`${g[1]}_${g[0]}`:g[0]},M=async v=>{const g=`https://dotnet-fapp.azurewebsites.net/api/GetSasToken?code=3-172eA71LvFWcg-aWsKHJlQu_VyQ0aFe9lxR0BrQsAJAzFux1i_pA%3D%3D&filename=${encodeURIComponent(v)}`;try{const x=await fetch(g,{method:"GET"});if(!x.ok)throw new Error(`SAS error: HTTP ${x.status}`);const q=await x.json();return I(q.sas_url),q.sas_url}catch(x){throw console.error("Error fetching SAS URL:",x),k.error("Failed to get SAS URL"),x}},l=async(v,g)=>{try{const x=await fetch(g,{method:"PUT",headers:{"x-ms-blob-type":"BlockBlob","Content-Type":v.type},body:v});if(!x.ok)throw new Error(`Upload failed with status: ${x.status}`);return k.success("Video uploaded successfully!"),g}catch(x){throw console.error("Error uploading file:",x),k.error("Upload failed"),x}},A=async v=>{if(v.preventDefault(),!w||!a){k.error("Please select a student and video before submitting.");return}j(!0),k.info("Getting SAS token...");try{const g=await M(a);g&&(k.success("SAS token received! Uploading..."),await l(n,g),c(!0))}catch{k.error("Error during submission. Check logs.")}finally{j(!1)}},K=async()=>{if(!b||!a||!L){k.warning("Ensure all steps are completed before analyzing.");return}j(!0),k.info("Submitting analysis...");try{const x="https://dotnet-fapp.azurewebsites.net/api/process_video?code=3-172eA71LvFWcg-aWsKHJlQu_VyQ0aFe9lxR0BrQsAJAzFux1i_pA%3D%3D",q={exercise:"shotput",video_url:L,stages:T.stages,user_id:H(w),deployment_id:"preprod",processing_id:"",timestamp:new Date().toISOString()},Z=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q)});if(!Z.ok)throw new Error(`Request failed with status ${Z.status}`);k.success("Analysis completed successfully!")}catch(v){k.error(`Error: ${v.message}`)}finally{j(!1)}};return e.jsx("div",{className:W.newAnalysis,children:e.jsxs("div",{className:W.newAnalysis__main,children:[e.jsxs("div",{className:W.newAnalysis__left,children:[e.jsx("div",{className:W.newAnalysis__title,children:"Create a new analysis"}),o?e.jsx("button",{className:W.newAnalysis__submit,onClick:K,disabled:S,children:S?"Processing...":"Analyze"}):e.jsxs("form",{onSubmit:A,children:[e.jsx(Ct,{setSelectedStudent:v=>{y(v),k.success(`Student ${H(v)} selected`)}}),e.jsx(ct,{onUpload:$,fileName:a,setFileName:h}),e.jsx("button",{type:"submit",className:W.newAnalysis__submit,disabled:S,children:S?"Uploading...":"Submit"})]})]}),o?e.jsx(Ns,{videoSrc:n,setIsStagesSaved:E,rubric:T,setRubric:R,currentStageIndex:C,setCurrentStageIndex:V}):e.jsx(At,{currentRubric:i,setCurrentRubric:d})]})})},ys="_history_1phjv_1",Es={history:ys},Ls=()=>e.jsx("div",{className:Es.history,children:"No records so far"}),Is="_feedback__top_ucy4u_1",ae={feedback__top:Is},Cs="_stages__list_1mzqm_1",Ts="_stages__item_1mzqm_6",$s="_red_1mzqm_39",Bs="_purple_1mzqm_45",Q={stages__list:Cs,stages__item:Ts,red:$s,purple:Bs},Ps=({stages:o,scores:c})=>e.jsx("div",{className:Q.stages,children:e.jsx("ul",{className:Q.stages__list,children:o.map((n,_)=>e.jsx("li",{className:`${Q.stages__item} ${`${c[_]===0?Q.red:c[_]===.5?Q.purple:""}`}`,children:n},_))})}),Ms=({rubrics:o})=>{const{userId:c,rubricId:n}=ke(),[_,i]=t.useState("Not Found"),[d,a]=t.useState(!0),[h,w]=t.useState([]),[y,b]=t.useState(null);return t.useEffect(()=>{o.length>n&&n>=0&&i(o[n].name),d&&setTimeout(()=>{a(!1);const E=[.5,0,1,1,1];w(E),b(E.reduce((S,j)=>S+j,0))},2e3)},[]),e.jsxs("div",{className:ae.feedback,children:[e.jsxs("div",{className:ae.feedback__top,children:[e.jsxs("h1",{className:ae.feedback__title,children:["Rubric: ",_]}),e.jsxs("div",{className:ae.feedback__score,children:[y,"/5"]})]}),e.jsx(Ps,{stages:o[n].rubrics,scores:h}),e.jsxs("p",{children:["User ID: ",c]}),e.jsxs("p",{children:["Rubric Name: ",n]})]})},As="_mainPage_8i7d0_1",Rs="_mainPage__container_8i7d0_7",ve={mainPage:As,mainPage__container:Rs},Ds=()=>{const[o,c]=t.useState([{id:0,name:"Start",rubrics:['Pelvis slightly higher than shoulders at "set"',"Head aligned with torso, looking at start line","Both legs push off powerfully, causing imbalance",'Body positioned like "a spear" during push-off',"Gaze directed slightly forward toward ground"]},{id:1,name:"Sprint",rubrics:["Runs on the balls of the feet","Knees are high","Active clawing motion of legs","Arms at 90° actively moving","Center of mass leans forward"]},{id:2,name:"Shot Put",rubrics:["Glide phase initiated with bent low leg, back to throw","Trailing leg pulled under pelvis after hop","Bracing leg planted; push leg bent after hop","Push leg extends, hip-torso-arm sequence begins","Shot remains at neck until 45° release"]},{id:3,name:"Height Jump",rubrics:["Accelerating approach with upright posture","Lean into curve","Full knee lift during takeoff, arm lifted high","Clears bar with an arched back",'Lands on mat in "L" shape, perpendicular to bar']},{id:4,name:"Hurdles (official spacing)",rubrics:["8 steps in approach","First hurdle cleared","Fully extended lead leg passes hurdle","Torso and opposite arm align with lead leg","Large stride for second contact post-hurdle"]},{id:5,name:"Long Jump",rubrics:["Accelerating approach without slowing before takeoff","Foot lands on white plank; no gaze at board","Takeoff foot flat, center of mass above it","Knight stance maintained during first half","Landing with sliding technique"]},{id:6,name:"Discus Throw",rubrics:["Throwing arm swings back after initial motion","Pivot initiated from ball of foot","Pivot performed flat toward circle center","Throw starts low-to-high with hip engagement","Discus released via index finger"]},{id:7,name:"Javelin Throw",rubrics:["Javelin brought backward during last 5 steps","Pelvis rotated, javelin fully retracted","Impulse step executed","Blocking step executed","Throw initiated through hip-torso involvement"]},{id:8,name:"Relay Race",rubrics:["Receiver starts after runner crosses mark without looking back","Receiver reaches maximum speed","Baton exchange occurs at speed after agreed signal","Baton switched hands, runner stays in lane","Exchange occurs within the zone"]}]);return e.jsxs("div",{className:"wrapper",children:[e.jsx(Me,{richColors:!0,position:"bottom-left",className:"toaster"}),e.jsx("div",{className:ve.mainPage,children:e.jsxs("div",{className:`${ve.mainPage__container} _container`,children:[e.jsx(Qe,{}),e.jsxs(pe,{children:[e.jsx(J,{path:"/",element:e.jsx(ks,{})}),e.jsx(J,{path:"/history",element:e.jsx(Ls,{})}),e.jsx(J,{path:"/feedback/:userId/:rubricId",element:e.jsx(Ms,{rubrics:o})})]})]})})]})},Fs=()=>{const[o,c]=t.useState(!0);return e.jsx(ye,{children:e.jsxs(pe,{children:[e.jsx(J,{path:"/*",element:o?e.jsx(Ds,{}):e.jsx(Ee,{to:"/login"})}),e.jsx(J,{path:"/login",element:e.jsx(Ae,{})}),e.jsx(J,{path:"/overview",element:e.jsx(We,{})})]})})};Ne.createRoot(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(Fs,{})}));
